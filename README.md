# Advanced Gemini Telegram Bot Agent

[![Python Version](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![aiogram](https://img.shields.io/badge/aiogram-3.x-blue.svg)](https://github.com/aiogram/aiogram)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT) 

–ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π Google Gemini API (–≤–∫–ª—é—á–∞—è Function Calling) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —à–∏—Ä–æ–∫–æ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞ –∑–∞–¥–∞—á. –ë–æ—Ç —Å–ø–æ—Å–æ–±–µ–Ω –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —É–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª–∞–º–∏ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö, –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–Ω–µ—à–Ω–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ò–ò:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥–µ–ª–∏ Google Gemini (Pro –∏ Lite) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –¥–∏–∞–ª–æ–≥–æ–≤.
*   **Function Calling:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –ò–ò –≤—ã–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ Python-—Ñ—É–Ω–∫—Ü–∏–∏ (–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã) –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏–π.
*   **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
    *   **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º:** –ß—Ç–µ–Ω–∏–µ, –∑–∞–ø–∏—Å—å, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (—Ç–µ–∫—Å—Ç, JSON, AST –¥–ª—è Python), —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤/–∫–æ–º–∞–Ω–¥ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞ (`/env/{chat_id}`). –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥—Ä—É–≥–∏–º –æ–∫—Ä—É–∂–µ–Ω–∏—è–º.
    *   **–ü–∞–º—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, —á—Ç–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö (–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç JSON –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö).
    *   **–í–µ–±-–ø–æ–∏—Å–∫ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç "Deep Search" –¥–ª—è –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ç–µ–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–µ–±-–ø–æ–∏—Å–∫–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞.
    *   **–í–Ω–µ—à–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ:** –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã, –∫–æ—Ç–∏—Ä–æ–≤–æ–∫ –∞–∫—Ü–∏–π, –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö —á–∞—Ä—Ç–æ–≤ (–Ø–Ω–¥–µ–∫—Å.–ú—É–∑—ã–∫–∞).
    *   **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:** –ü–æ–∏—Å–∫ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ (—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Vision API).
    *   **–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è:** –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –æ—Ç –∏–º–µ–Ω–∏ –±–æ—Ç–∞ (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –æ—Ç–≤–µ—Ç–∞ –ò–ò).
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `aiosqlite` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–æ–≤, –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∑–∞–º–µ—Ç–æ–∫, –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–∞—Ç–æ–≤, –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ –Ω–æ–≤–æ—Å—Ç–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ –ª–æ–≥–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –í–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º WAL –¥–ª—è –ª—É—á—à–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `.env` —Å –ø–æ–º–æ—â—å—é `pydantic-settings`.
*   **–°–µ—Ä–≤–∏—Å—ã:**
    *   **–ú–µ–Ω–µ–¥–∂–µ—Ä –æ–∫—Ä—É–∂–µ–Ω–∏–π:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö.
    *   **–°–µ—Ä–≤–∏—Å –Ω–æ–≤–æ—Å—Ç–µ–π:** (–ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω) –ú–æ–∂–µ—Ç –ø–∞—Ä—Å–∏—Ç—å RSS-–ª–µ–Ω—Ç—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –≤ –∫–∞–Ω–∞–ª—ã –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç `feedparser`, `aiohttp`, `BeautifulSoup`).
*   **Telegram –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`aiogram 3.x`):**
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö).
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Ç–∏–ø—É —á–∞—Ç–∞ –∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è–º/–æ—Ç–≤–µ—Ç–∞–º).
    *   –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ).
    *   FSM –¥–ª—è –ø–æ—à–∞–≥–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π).
    *   Middlewares: –ê–Ω—Ç–∏—Ñ–ª—É–¥, —Å—á–µ—Ç—á–∏–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
    *   –§–∏–ª—å—Ç—Ä—ã: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±–æ—Ç–∞.
    *   –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –ò–ò, –≤–∫–ª—é—á–∞—è –Ω–µ–¥–∞–≤–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (RAG) –∏ –∑–∞–º–µ—Ç–∫–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ü—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ .env.example           # –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md              # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ requirements.txt       # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ Agent/                 # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º –±–æ—Ç–∞ (–∏–ª–∏ –≤–∞—à–µ –∏–º—è)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ bot_loader.py      # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Bot –∏ Dispatcher
‚îÇ   ‚îú‚îÄ‚îÄ bot_lifecycle.py   # –õ–æ–≥–∏–∫–∞ on_startup / on_shutdown
‚îÇ   ‚îú‚îÄ‚îÄ config.py          # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Pydantic)
‚îÇ   ‚îú‚îÄ‚îÄ core_agent/        # –Ø–¥—Ä–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ AI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agent_processor.py # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ (Lite/Pro)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai_interaction.py  # –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Gemini API (–≤—ã–∑–æ–≤—ã, FC —Ü–∏–∫–ª)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fc_processing.py   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Function Calls
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ history_manager.py # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ result_parser.py   # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∏–∑ –æ—Ç–≤–µ—Ç–∞ AI
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ response_parsers.py # –ü–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ Lite –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ ai_interface/      # –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫ AI API
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gemini_api.py    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–µ–π, –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Gemini
‚îÇ   ‚îú‚îÄ‚îÄ database/          # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (aiosqlite)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connection.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ crud_ops/        # –ú–æ–¥—É–ª–∏ —Å CRUD-–æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü
‚îÇ   ‚îú‚îÄ‚îÄ tools/             # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (—Ñ—É–Ω–∫—Ü–∏–∏) –¥–ª—è Function Calling
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py      # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ basic_tools.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ communication_tools.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ environment_tools.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_data_tools.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deep_search_tool.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ _ast_transformer.py # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π –¥–ª—è environment_tools
‚îÇ   ‚îú‚îÄ‚îÄ services/          # –§–æ–Ω–æ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ env_manager.py   # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º –∫ —Ñ–∞–π–ª–æ–≤—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏—è–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ news_service.py  # –°–µ—Ä–≤–∏—Å —Ä–∞—Å—Å—ã–ª–∫–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –ø–æ RSS
‚îÇ   ‚îú‚îÄ‚îÄ telegram_interface/ # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Telegram
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/        # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ–º–∞–Ω–¥, –∫–æ–ª–±—ç–∫–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filters/         # –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (e.g., IsAdminFilter)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/     # –ö–∞—Å—Ç–æ–º–Ω—ã–µ middleware (Antiflood, Stats)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ states/          # –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ keyboards/       # (–ü—É—Å—Ç–æ) –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ utils/             # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ helpers.py       # –û–±—â–∏–µ —Ö–µ–ª–ø–µ—Ä—ã (is_admin, escape_markdown)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ converters.py    # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏ Gemini
‚îÇ   ‚îú‚îÄ‚îÄ prompts/             # –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏ –¥–ª—è AI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lite_analyzer.txt
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pro_assistant.txt
‚îÇ   ‚îú‚îÄ‚îÄ declarations/        # JSON-—Ñ–∞–π–ª—ã —Å –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è–º–∏ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è Gemini
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lite_functions.json
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pro_functions.json
‚îÇ   ‚îî‚îÄ‚îÄ database/            # (–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ?) –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–æ–µ –∏–º—è –¥–ª—è –ë–î —Ñ–∞–π–ª–∞
‚îÇ       ‚îî‚îÄ‚îÄ bot_db.sqlite    # –§–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite
‚îú‚îÄ‚îÄ logs/                  # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–æ–≤ (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îî‚îÄ‚îÄ docs/                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îî‚îÄ‚îÄ architecture.md    # –û–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

*   `BOT_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram –±–æ—Ç–∞.
*   `GOOGLE_API_KEY`: –í–∞—à API –∫–ª—é—á –¥–ª—è Google AI (Gemini API).
*   `ADMIN_IDS`: –°–ø–∏—Å–æ–∫ ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, `12345678,98765432`).

–î—Ä—É–≥–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∏–º–µ–Ω–∞ –º–æ–¥–µ–ª–µ–π, –ø—É—Ç–∏, –ª–∏–º–∏—Ç—ã, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏) –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `config.py` –∏–ª–∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤ `.env`.

**–í–Ω–∏–º–∞–Ω–∏–µ:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–º–ø—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `pro_assistant.txt`) –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ User ID. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏—Ç—å –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ–¥ –≤–∞—à–∏ –Ω—É–∂–¥—ã.

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–ø—É—Å–∫

1.  **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
    ```bash
    git clone <your-repo-url>
    cd <repository-folder>
    ```
2.  **–°–æ–∑–¥–∞—Ç—å –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:** (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
    ```bash
    python -m venv venv
    # Windows
    venv\Scripts\activate
    # macOS/Linux
    source venv/bin/activate
    ```
3.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
    ```bash
    pip install -r requirements.txt
    ```
4.  **–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env`:**
    –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –∫–∞–∫ –º–∏–Ω–∏–º—É–º `BOT_TOKEN`, `GOOGLE_API_KEY`, `ADMIN_IDS`.
    ```bash
    cp .env.example .env
    # nano .env  –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞—à —Ä–µ–¥–∞–∫—Ç–æ—Ä
    ```
5.  **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)** –ò–∑—É—á–∏—Ç–µ `config.py`, `prompts/` –∏ `declarations/` –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–π –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏.
6.  **–ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞:**
    ```bash
    python Agent/main.py # –ò–ª–∏ python main.py, –µ—Å–ª–∏ main.py –≤ –∫–æ—Ä–Ω–µ
    ```
    –ë–æ—Ç –Ω–∞—á–Ω–µ—Ç —Ä–∞–±–æ—Ç—É, —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (`Agent/database/bot_db.sqlite` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ª–æ–≥–æ–≤ (`logs/`).

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ Function Calling

–ë–æ—Ç –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º Function Calling –æ—Ç Google Gemini.

*   **–î–µ–∫–ª–∞—Ä–∞—Ü–∏–∏:** –û–ø–∏—Å–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ (—Ñ—É–Ω–∫—Ü–∏–π) –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ JSON-—Ñ–∞–π–ª–∞—Ö –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `declarations/`. –≠—Ç–∏ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –º–æ–¥–µ–ª–∏ Gemini.
*   **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –§—É–Ω–∫—Ü–∏–∏-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –º–æ–¥—É–ª—è—Ö –≤–Ω—É—Ç—Ä–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `tools/`. –û–Ω–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞.
*   **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:** –ú–æ–¥–µ–ª—å Gemini —Ä–µ—à–∞–µ—Ç, –∫–æ–≥–¥–∞ –∏ —Å –∫–∞–∫–∏–º–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –≤—ã–∑–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. –ë–æ—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é Python-—Ñ—É–Ω–∫—Ü–∏—é –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–¥–µ–ª–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏.

## üíæ –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö

*   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SQLite (`aiosqlite`) –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã.
*   –§–∞–π–ª –ë–î –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `Agent/database/bot_db.sqlite`.
*   –°—Ö–µ–º–∞ –ë–î —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ (`database/connection.py -> init_db`).
*   –í–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º WAL –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏.
*   –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –ø–æ —Ç–∞–±–ª–∏—Ü–∞–º –≤ `database/crud_ops/`.

## üå≥ –ú–µ–Ω–µ–¥–∂–µ—Ä –û–∫—Ä—É–∂–µ–Ω–∏–π

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏ –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤/–∫–æ–º–∞–Ω–¥ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞ –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–∫–∏ `env/` (–ø—É—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ `config.py`).

*   –ü—É—Ç—å: `/path/to/project/env/{chat_id}/`
*   `env_manager.py` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—É—Ç–µ–π, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.
*   –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã –±–æ—Ç–∞ (—É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ `ADMIN_IDS`) –∏–º–µ—é—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ –∏ –º–æ–≥—É—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è—Ö –¥—Ä—É–≥–∏—Ö —á–∞—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è).

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

(TODO) –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `tests/` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è unit- –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤, –Ω–æ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –ø—É—Å—Ç–∞. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ —è–≤–ª—è–µ—Ç—Å—è –≤–∞–∂–Ω—ã–º —à–∞–≥–æ–º –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

[MIT License]

---
